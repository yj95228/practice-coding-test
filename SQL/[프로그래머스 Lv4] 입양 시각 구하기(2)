-- https://programmers.co.kr/learn/courses/30/lessons/59413?language=mysql
-- 코드를 입력하세요
SELECT HOUR, IFNULL(COUNT,0) AS COUNT
FROM (
    SELECT ROW_NUMBER() OVER(ORDER BY DATETIME)-1 AS HOUR
    FROM ANIMAL_OUTS 
    LIMIT 24
) AS HOURS
LEFT JOIN (
    SELECT HOUR(DATETIME) AS HOUR, COUNT(*) AS COUNT
    FROM ANIMAL_OUTS
    GROUP BY HOUR
) AS ANIMAL
USING(HOUR)
